---
# SNMP Trap Special variables
#
# $$ = a literal dollar sign
# $a = agent-addr (IP)
# $A = agent-addr
# $s = SNMP version
# $b = PDU source address
# $B = PDU source hostname
# $x = time on local system
# $X = date on local system
# $N = enterprise string
# $q = trap sub-type
# $P = security information from the PDU
# $O = trap oid
# $t = seconds since system epoch
# $T = sysUpTime
# $w = trap type
# $W = trap description
# $n = varbind 'n'
# $# = number of varbinds


# Defaults
#
# resource: (str) $B or $A
# event: (str) $O
# severity: NORMAL (CRITICAL, MAJOR, MINOR, WARNING, INDETERMINATE, CLEARED, NORMAL, INFORM, DEBUG, AUTH, UNKNOWN)
# group: (str) SNMP
# value: (str) $w
# text: (str) $W
# environment: (list) INFRA
# service: (list) Network
# correlate: (list) null
# tags: (list) $s
# threshold_info: (str) null
# summary: (str) system default
# timeout: (int) system default

# Suppression flag
#
# suppress: (bool) False


# Oracle Enterprise Manager

- trapoid: ORACLE-ENTERPRISE-MANAGER-4-MIB
  group: Database
  service: R2
  parser: OracleEMTrapParser

# ZXTM Pool Traps

- trapoid: ZXTM-MIB::pooldied
  event: ZxtmPoolStatus
  value: Died
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

- trapoid: ZXTM-MIB::poolok
  event: ZxtmPoolStatus
  value: OK
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

# ZXTM Node Traps

- trapoid: ZXTM-MIB::nodefail
  event: ZxtmNodeStatus
  value: Fail
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

- trapoid: ZXTM-MIB::nodeworking
  event: ZxtmNodeStatus
  value: Working
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

# ZXTM Monitor Traps

- trapoid: ZXTM-MIB::monitorfail
  event: ZxtmMonitorStatus
  value: Fail
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

- trapoid: ZXTM-MIB::monitorok
  event: ZxtmMonitorStatus
  value: OK
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

# ZXTM Rule Msg Traps

- trapoid: ZXTM-MIB::rulelogmsginfo
  event: ZxtmRuleMsg
  value: Info
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

# ZXTM Trap catch-all

- trapoid: ZXTM-MIB
  resource: $4
  group: ZXTM
  parser: ZxtmTrapParser

# IPMI PET Event Traps

- trapoid: PET-EVENTS
  group: Hardware
  parser: IpmiTrapParser

# NetApp Traps

- trapoid: NETAPP-MIB
  value: $S
  group: NetApp
  tags: [ serial_num=$4 ]

